import { DocsHeader } from "../_components/docs-header";

<DocsHeader
  title="Code Block"
  description="Display syntax-highlighted code snippets."
  mdxPath="app/docs/code-block/content.mdx"
/>

<CodeBlockPresetExample preset="typescript" />

## Key Features

<FeatureGrid>
  <Feature icon="Palette" title="Syntax highlighting">
    Powered by Shiki with support for 100+ languages
  </Feature>
  <Feature icon="Highlighter" title="Line highlighting">
    Highlight specific lines for explanations or bug indicators
  </Feature>
  <Feature icon="FoldVertical" title="Collapsible mode">
    Auto-collapse long snippets to keep conversations scannable
  </Feature>
  <Feature icon="FileCode" title="Filename header">
    Show filename and language badge for context
  </Feature>
</FeatureGrid>

## Source and Install

Copy [`components/tool-ui/code-block`](https://github.com/assistant-ui/tool-ui/tree/main/components/tool-ui/code-block) and the [`shared`](https://github.com/assistant-ui/tool-ui/tree/main/components/tool-ui/shared) directory into your project. The `shared` folder contains utilities used by all Tool UI components. The `tool-ui` directory should sit alongside your shadcn `ui` directory.

### Prerequisites

This component requires the following [shadcn/ui](https://ui.shadcn.com) components:

```bash
pnpm dlx shadcn@latest add button
```

It also uses [Radix Collapsible](https://www.radix-ui.com/primitives/docs/components/collapsible) directly:

```bash
pnpm add @radix-ui/react-collapsible
```

### Directory Structure

<Files>
  <Folder name="components" defaultOpen>
    <Folder name="ui">
      <File name="button.tsx" />
      <File name="..." />
    </Folder>
    <Folder name="tool-ui" defaultOpen>
      <Folder name="shared" defaultOpen>
        <File name="action-buttons.tsx" />
        <File name="schema.ts" />
        <File name="index.ts" />
        <File name="..." />
      </Folder>
      <Folder name="code-block" defaultOpen>
        <File name="code-block.tsx" />
        <File name="schema.ts" />
        <File name="index.tsx" />
        <File name="_adapter.tsx" />
      </Folder>
    </Folder>
  </Folder>
</Files>

### Download

- [**Shared Dependencies (GitHub)**](https://github.com/assistant-ui/tool-ui/tree/main/components/tool-ui/shared) ([ZIP](https://download-directory.github.io/?url=https://github.com/assistant-ui/tool-ui/tree/main/components/tool-ui/shared))
- [**Code Block (GitHub)**](https://github.com/assistant-ui/tool-ui/tree/main/components/tool-ui/code-block) ([ZIP](https://download-directory.github.io/?url=https://github.com/assistant-ui/tool-ui/tree/main/components/tool-ui/code-block))

Install dependencies ([Shiki](https://shiki.style/) for syntax highlighting):

```bash
pnpm add shiki
```

## Usage

```tsx
import { CodeBlock } from "@/components/tool-ui/code-block";

export function MyComponent() {
  return (
    <CodeBlock
      id="my-code-example"
      code={`function hello(name: string) {
  return \`Hello, \${name}!\`;
}`}
      language="typescript"
      filename="hello.ts"
      showLineNumbers={true}
    />
  );
}
```

### With assistant-ui (tool output)

Define a tool that returns Code Block props, then render the component with runtime validation.

```tsx
// Backend tool
import { tool, jsonSchema } from "ai";

const showCodeBlock = tool({
  description: "Show a code snippet",
  inputSchema: jsonSchema<{}>({
    type: "object",
    properties: {},
    additionalProperties: false,
  }),
  async execute() {
    return {
      id: "code-block-1",
      code: "console.log('hello');",
      language: "javascript",
      filename: "hello.js",
      highlightLines: [1],
    };
  },
});

// Frontend with assistant-ui
import { makeAssistantToolUI } from "@assistant-ui/react";
import {
  CodeBlock,
  CodeBlockErrorBoundary,
  parseSerializableCodeBlock,
} from "@/components/tool-ui/code-block";

function ParsedCodeBlock({ result }: { result: unknown }) {
  const props = parseSerializableCodeBlock(result);
  return <CodeBlock {...props} />;
}

export const ShowCodeBlockUI = makeAssistantToolUI({
  toolName: "showCodeBlock",
  render: ({ result }) => {
    // Tool outputs stream in; `result` will be `undefined` until the tool resolves.
    if (result === undefined) {
      return <div className="text-muted-foreground text-sm">Loadingâ€¦</div>;
    }

    return (
      <CodeBlockErrorBoundary>
        <ParsedCodeBlock result={result} />
      </CodeBlockErrorBoundary>
    );
  },
});
```

## Props

### Core Props

<TypeTable
  type={{
    code: {
      description: "The code content to display",
      type: "string",
      required: true,
    },
    language: {
      description: "Programming language for syntax highlighting",
      type: "string",
      default: '"text"',
    },
    filename: {
      description: "Filename to display in the header",
      type: "string",
    },
  }}
/>

### Display Options

<TypeTable
  type={{
    showLineNumbers: {
      description: "Show line numbers",
      type: "boolean",
      default: "true",
    },
    highlightLines: {
      description: "Array of line numbers to highlight",
      type: "number[]",
    },
    maxCollapsedLines: {
      description: "Auto-collapse if code exceeds this many lines",
      type: "number",
    },
  }}
/>

### Standard Props

<TypeTable
  type={{
    id: {
      description: "Unique identifier for this component",
      type: "string",
      required: true,
    },
    responseActions: {
      description: "Response action buttons",
      type: "Action[]",
    },
    className: {
      description: "Additional CSS classes",
      type: "string",
    },
  }}
/>

## Supported Languages

CodeBlock supports all languages included with Shiki, including:

- TypeScript/JavaScript
- Python
- JSON
- Bash/Shell
- CSS/HTML
- Markdown
- SQL
- YAML
- Go
- Rust
- And many more...

See [Shiki documentation](https://shiki.style/languages) for the complete list.

## Accessibility

- Collapsible sections use Radix Collapsible with proper ARIA attributes
- Copy button is keyboard-accessible with focus indication
- Code content is selectable and works with screen readers
