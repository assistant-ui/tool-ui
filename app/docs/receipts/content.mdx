import { DocsHeader } from "../_components/docs-header";
import { MockThread, MockMessage } from "../_components/mock-thread";
import { OptionList } from "@/components/tool-ui/option-list";
import { ApprovalCard } from "@/components/tool-ui/approval-card";

<DocsHeader
  title="Receipts"
  description="Confirm what happened after a user decision."
  mdxPath="app/docs/receipts/content.mdx"
/>

When a user takes an action with consequences, the tool UI should transition to a **receipt state** that confirms what happened. This gives the user proof of their decision and gives the assistant something to reference later.

## Why Receipts Matter

Without receipts, consequential actions vanish into the conversation history. The user can't verify what they chose. The assistant can't reference specific decisions. Receipts solve both problems.

<div className="mx-auto max-w-2xl">
  <MockThread caption="A decision with receipt">
    <MockMessage role="assistant">
      <span className="text-foreground">
        How would you like to handle the duplicate contacts?
      </span>
      <div className="mt-3">
        <OptionList
          selectionMode="single"
          choice="merge"
          options={[
            {
              id: "merge",
              label: "Merge duplicates",
              description: "Combine into single contacts, keeping all data",
            },
            {
              id: "keep",
              label: "Keep all",
              description: "Leave duplicates as separate contacts",
            },
            {
              id: "review",
              label: "Review manually",
              description: "I'll decide for each duplicate",
            },
          ]}
        />
      </div>
    </MockMessage>
    <MockMessage role="assistant">
      <span className="text-foreground">
        Done. I merged 12 duplicate contacts. You can undo this from Settings →
        Contact History if needed.
      </span>
    </MockMessage>
  </MockThread>
</div>

The receipt shows what the user chose. The assistant's follow-up confirms the outcome and offers a way to reverse it.

## Writing Receipt Copy

Receipts describe a past decision. The copy should reflect this.

### The Decision Label

The decision label (e.g., "Approved", "Denied", "Selected") should be **past tense** because it describes what the user decided:

| Interactive State | Receipt State |
|-------------------|---------------|
| Approve           | Approved      |
| Deny              | Denied        |
| Select            | Selected      |
| Confirm           | Confirmed     |

### The Action Description

The action description stays in **imperative form** because it describes the request that was approved or denied, not the outcome:

<div className="not-prose grid gap-4 sm:grid-cols-2 my-6">
  <div>
    <p className="text-sm text-muted-foreground mb-2">Approved action</p>
    <ApprovalCard
      id="receipt-approved-example"
      title="Back up database"
      choice="approved"
    />
  </div>
  <div>
    <p className="text-sm text-muted-foreground mb-2">Denied action</p>
    <ApprovalCard
      id="receipt-denied-example"
      title="Delete all project files"
      choice="denied"
    />
  </div>
</div>

The pattern is: **[Past-tense decision] — [Imperative action]**

- "Approved — Back up database" (the request to back up was approved)
- "Denied — Delete all project files" (the request to delete was denied)
- "Selected — Merge duplicates" (the option to merge was selected)

## Components with Receipt States

Several Tool UI components support receipt states:

| Component | Receipt Prop | What It Shows |
|-----------|--------------|---------------|
| [Approval Card](/docs/approval-card) | `choice` | The decision and action title |
| [Option List](/docs/option-list) | `choice` | Only the selected option(s) |
| [Preferences Panel](/docs/preferences-panel) | `choice` | Summary of saved preferences |
| [Progress Tracker](/docs/progress-tracker) | `choice` | Final status of the workflow |
| [Order Summary](/docs/order-summary) | `choice` | Confirmed order details |

## When to Use Receipts

Use receipts for **consequential decisions** that:

- Change state (approvals, deletions, submissions)
- Can't be easily undone
- The user or assistant might need to reference later

Skip receipts for **reversible controls** like:

- Sorting or filtering data
- Adjusting parameters
- Navigating between views

The assistant's follow-up message should acknowledge the receipt and, when appropriate, offer a way to undo or modify the decision.
