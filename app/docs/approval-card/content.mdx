import { DocsHeader } from "../_components/docs-header";
import { ApprovalCard, ApprovalCardReceipt } from "@/components/tool-ui/approval-card";

<DocsHeader
  title="Approval Card"
  description="Binary confirmation for agent actions."
  mdxPath="app/docs/approval-card/content.mdx"
/>

<Tabs items={["Preview", "Code"]}>
  <Tab>
    <div className="not-prose mx-auto max-w-sm">
      <ApprovalCard
        id="approval-card-example"
        title="Deploy to Production?"
        description="This will push the latest changes to all users."
        icon="rocket"
        confirmLabel="Deploy"
      />
    </div>
  </Tab>
  <Tab>
    ```tsx
    import { ApprovalCard } from "@/components/tool-ui/approval-card";

    export function Example() {
      return (
        <ApprovalCard
          id="approval-card-example"
          title="Deploy to Production?"
          description="This will push the latest changes to all users."
          icon="rocket"
          confirmLabel="Deploy"
          onConfirm={() => console.log("Approved")}
          onCancel={() => console.log("Denied")}
        />
      );
    }
    ```
  </Tab>
</Tabs>

> **Note:** Buttons use a responsive layoutâ€”they appear as compact pills at wider widths and stack full-width on narrow containers.

## Features

<FeatureGrid>
  <Feature icon="ShieldCheck" title="Human-in-the-loop">
    Gate agent actions with explicit user approval
  </Feature>
  <Feature icon="AlertTriangle" title="Destructive variant">
    Warning styling for dangerous operations
  </Feature>
  <Feature icon="List" title="Contextual metadata">
    Show key-value details about what's being approved
  </Feature>
  <Feature icon="CheckCircle2" title="Receipt state">
    Display the decision outcome in conversation history
  </Feature>
</FeatureGrid>

## Receipt State

Use `<ApprovalCardReceipt>` to render a compact receipt state showing the approval decision. This is ideal for displaying the outcome in conversation history.

<Tabs items={["Approved", "Denied"]}>
  <Tab>
    <div className="not-prose mx-auto max-w-sm">
      <ApprovalCardReceipt
        id="receipt-approved-example"
        title="Deploy to Production"
        choice="approved"
        confirmLabel="Deploy"
      />
    </div>
  </Tab>
  <Tab>
    <div className="not-prose mx-auto max-w-sm">
      <ApprovalCardReceipt
        id="receipt-denied-example"
        title="Delete Project"
        choice="denied"
        variant="destructive"
        confirmLabel="Delete"
        cancelLabel="Keep"
      />
    </div>
  </Tab>
</Tabs>

The receipt state:

- Shows the decision (approved/denied) with a checkmark or X icon
- Displays the custom button label used (e.g., "Deploy" instead of generic "Approved")
- Fades in with a subtle animation
- Is read-only (no interaction)

## Destructive Variant

Use `variant="destructive"` for dangerous or irreversible actions. This changes the icon background and confirm button to destructive styling.

<Tabs items={["Preview", "Code"]}>
  <Tab>
    <div className="not-prose mx-auto max-w-sm">
      <ApprovalCard
        id="destructive-example"
        title="Delete Project?"
        description="This action cannot be undone. All data will be permanently removed."
        icon="trash-2"
        variant="destructive"
        confirmLabel="Delete"
        cancelLabel="Keep"
      />
    </div>
  </Tab>
  <Tab>
    ```tsx
    <ApprovalCard
      id="destructive-example"
      title="Delete Project?"
      description="This action cannot be undone."
      icon="trash-2"
      variant="destructive"
      confirmLabel="Delete"
      cancelLabel="Keep"
      onConfirm={() => deleteProject()}
      onCancel={() => console.log("Kept")}
    />
    ```
  </Tab>
</Tabs>

## Source and Install

Copy [`components/tool-ui/approval-card`](https://github.com/assistant-ui/tool-ui/tree/main/components/tool-ui/approval-card) and the [`shared`](https://github.com/assistant-ui/tool-ui/tree/main/components/tool-ui/shared) directory into your project. The `shared` folder contains utilities used by all Tool UI components. The `tool-ui` directory should sit alongside your shadcn `ui` directory.

### Prerequisites

This component requires the following [shadcn/ui](https://ui.shadcn.com) components:

```bash
pnpm dlx shadcn@latest add button
```

### Directory Structure

<Files>
  <Folder name="components" defaultOpen>
    <Folder name="ui">
      <File name="button.tsx" />
      <File name="..." />
    </Folder>
    <Folder name="tool-ui" defaultOpen>
      <Folder name="shared" defaultOpen>
        <File name="action-buttons.tsx" />
        <File name="schema.ts" />
        <File name="parse.ts" />
        <File name="index.ts" />
        <File name="..." />
      </Folder>
      <Folder name="approval-card" defaultOpen>
        <File name="approval-card.tsx" />
        <File name="schema.ts" />
        <File name="index.tsx" />
        <File name="..." />
      </Folder>
    </Folder>
  </Folder>
</Files>

### Download

- [**Shared Dependencies (GitHub)**](https://github.com/assistant-ui/tool-ui/tree/main/components/tool-ui/shared) ([ZIP](https://download-directory.github.io/?url=https://github.com/assistant-ui/tool-ui/tree/main/components/tool-ui/shared))
- [**Approval Card (GitHub)**](https://github.com/assistant-ui/tool-ui/tree/main/components/tool-ui/approval-card) ([ZIP](https://download-directory.github.io/?url=https://github.com/assistant-ui/tool-ui/tree/main/components/tool-ui/approval-card))

## Usage

```tsx
"use client";

import { makeAssistantTool } from "@assistant-ui/react";
import {
  ApprovalCard,
  ApprovalCardReceipt,
  ApprovalCardErrorBoundary,
  parseSerializableApprovalCard,
  SerializableApprovalCardSchema,
  type SerializableApprovalCard,
  type ApprovalDecision,
} from "@/components/tool-ui/approval-card";

export const ApprovalTool = makeAssistantTool<
  SerializableApprovalCard,
  ApprovalDecision
>({
  toolName: "requestApproval",
  description: "Request user approval before performing an action.",
  parameters: SerializableApprovalCardSchema,
  render: ({ args, result, addResult, toolCallId }) => {
    if (!(args as any)?.title) return null;

    const approvalCard = parseSerializableApprovalCard({
      ...args,
      id: (args as any)?.id ?? `approval-${toolCallId}`,
    });

    return (
      <ApprovalCardErrorBoundary>
        {result !== undefined ? (
          <ApprovalCardReceipt {...approvalCard} choice={result} />
        ) : (
          <ApprovalCard
            {...approvalCard}
            onConfirm={() => addResult("approved")}
            onCancel={() => addResult("denied")}
          />
        )}
      </ApprovalCardErrorBoundary>
    );
  },
});
```

Mount `<ApprovalTool />` under `<AssistantRuntimeProvider>` to register the tool and its UI.

## Props

<TypeTable
  type={{
    id: {
      description: "Unique identifier for the approval card",
      type: "string",
      required: true,
    },
    title: {
      description: "The action being approved",
      type: "string",
      required: true,
    },
    description: {
      description: "Additional context about the action",
      type: "string",
    },
    icon: {
      description: "Lucide icon name in kebab-case (e.g., \"rocket\", \"trash-2\", \"alert-triangle\")",
      type: "string",
    },
    metadata: {
      description: "Key-value pairs providing context",
      type: "MetadataItem[]",
    },
    variant: {
      description: "Visual style variant",
      type: "'default' | 'destructive'",
      default: "'default'",
    },
    confirmLabel: {
      description: "Label for the confirm button",
      type: "string",
      default: "'Approve'",
    },
    cancelLabel: {
      description: "Label for the cancel button",
      type: "string",
      default: "'Deny'",
    },
    isLoading: {
      description: "Disables both buttons while an external operation is in progress",
      type: "boolean",
    },
    onConfirm: {
      description: "Handler when user approves",
      type: "() => void | Promise<void>",
    },
    onCancel: {
      description: "Handler when user denies",
      type: "() => void | Promise<void>",
    },
  }}
/>

## Metadata Schema

<TypeTable
  type={{
    key: {
      description: "Label for the metadata item",
      type: "string",
      required: true,
    },
    value: {
      description: "Value to display",
      type: "string",
      required: true,
    },
  }}
/>

Long metadata values are automatically truncated with an ellipsis. Keep values concise for best results.

## Accessibility

- Uses `role="dialog"` with `aria-labelledby` and `aria-describedby`
- **Keyboard navigation:**
  - `Tab` to move between buttons
  - `Enter` or `Space` to activate focused button
  - `Escape` triggers the cancel action
- Loading state disables both buttons to prevent double-submission
- Receipt state uses `role="status"` for screen reader announcements
- Fade-in animation respects `prefers-reduced-motion`
