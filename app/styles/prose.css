@layer utilities {
  .prose {
    @apply text-foreground;
  }

  .prose :where(h1):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply mt-0 mb-2 flex flex-wrap items-center gap-3 text-4xl font-medium tracking-normal;
  }

  .prose :where(h2):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply mb-4 text-2xl font-medium;
  }

  .prose
    :where(h2:not(:first-child)):not(
      :where([class~="not-prose"], [class~="not-prose"] *)
    ) {
    @apply mt-16;
  }

  .prose :where(h3):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply mt-8 mb-3 text-xl font-medium;
  }

  .prose :where(h4):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply mt-6 mb-2 text-lg;
  }

  .prose :where(p):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply mb-4;
  }

  .prose
    :where(.lead):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply text-muted-foreground mb-6 text-xl leading-relaxed;
  }

  .prose :where(a):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply text-primary hover:text-primary/80 font-medium decoration-1 transition-colors;
  }

  .prose
    :where(strong):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply text-foreground font-semibold;
  }

  .prose
    :where(ul, ol):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    /* Reduce default left indent for lists */
    @apply my-4 ml-4 space-y-2;
  }

  /* Reduce indent for nested lists as well */
  .prose
    :where(li > ul, li > ol):not(
      :where([class~="not-prose"], [class~="not-prose"] *)
    ) {
    @apply ml-4;
  }

  .prose :where(ul):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply list-disc;
  }

  .prose :where(ol):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply list-decimal;
  }

  .prose :where(li):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply leading-7;
  }

  .prose
    :where(li > p):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply my-2;
  }

  .prose
    :where(code):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply bg-primary/10 dark:bg-primary/15 rounded-md border-none px-1.5 py-1 font-mono;
  }

  /* Remove Tailwind Typography's visible backtick quotes around inline code */
  .prose :where(:not(pre) > code)::before,
  .prose :where(:not(pre) > code)::after {
    content: none !important;
  }

  .prose :where(pre):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply my-6 overflow-x-auto rounded-lg bg-red-500 p-4;
  }

  .prose
    :where(pre code):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply bg-transparent p-0;
  }

  .prose
    :where(blockquote):not(
      :where([class~="not-prose"], [class~="not-prose"] *)
    ) {
    @apply border-primary text-muted-foreground my-6 border-l-4 pl-4 font-normal italic;
  }

  /* Remove quote marks around blockquoted text */
  .prose :where(blockquote)::before,
  .prose :where(blockquote)::after {
    content: none !important;
  }

  .prose :where(hr):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply border-border my-8;
  }

  .prose
    :where(table):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply my-6 w-full border-collapse;
  }

  .prose
    :where(thead):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply border-border border-b;
  }

  .prose :where(th):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply p-2 text-left font-semibold;
  }

  .prose :where(td):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply border-border border-t p-2;
  }
}
