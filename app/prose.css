@layer utilities {
  /* Prose (MDX) typography styles */
  .prose {
    @apply text-foreground;
  }

  .prose :where(h1):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply text-4xl mt-0 mb-2 flex items-center gap-3 flex-wrap font-medium;
  }

  .prose :where(h2):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply text-3xl mt-12 mb-4 font-medium;
  }

  /* Add extra spacing before subsequent sections that start with an h2 */
  .prose :where(h2:not(:first-child)):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply mt-20;
  }

  .prose :where(h3):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply text-2xl mt-8 mb-3 font-medium;
  }

  .prose :where(h4):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply text-lg mt-6 mb-2;
  }

  .prose :where(p):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply mb-4;
  }

  .prose :where(.lead):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply text-xl text-muted-foreground leading-relaxed mb-6;
  }

  .prose :where(a):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply text-primary font-medium hover:text-primary/80 transition-colors;
  }

  .prose :where(strong):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply font-semibold text-foreground;
  }

  .prose :where(ul, ol):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    /* Reduce default left indent for lists */
    @apply my-4 ml-4 space-y-2;
  }

  /* Reduce indent for nested lists as well */
  .prose :where(li > ul, li > ol):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply ml-4;
  }

  .prose :where(ul):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply list-disc;
  }

  .prose :where(ol):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply list-decimal;
  }

  .prose :where(li):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply leading-7;
  }

  .prose :where(li > p):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply my-2;
  }

  .prose :where(code):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply px-1.5 py-1 rounded-md font-mono border-none bg-primary/10 dark:bg-primary/15;
  }

  /* Remove Tailwind Typography's visible backtick quotes around inline code */
  .prose :where(:not(pre) > code)::before,
  .prose :where(:not(pre) > code)::after {
    content: none !important;
  }

  .prose :where(pre):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply p-4 rounded-lg overflow-x-auto my-6 bg-red-500;
  }

  .prose :where(pre code):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply bg-transparent p-0;
  }

  .prose :where(blockquote):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply border-l-4 border-primary pl-4 italic text-muted-foreground my-6 font-normal;
  }

  /* Remove quote marks around blockquoted text */
  .prose :where(blockquote)::before,
  .prose :where(blockquote)::after {
    content: none !important;
  }

  .prose :where(hr):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply border-border my-8;
  }

  .prose :where(table):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply w-full my-6 border-collapse;
  }

  .prose :where(thead):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply border-b border-border;
  }

  .prose :where(th):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply text-left font-semibold p-2;
  }

  .prose :where(td):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
    @apply p-2 border-t border-border;
  }
}
